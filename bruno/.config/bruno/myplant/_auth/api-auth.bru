meta {
  name: /api/auth
  type: http
  seq: 1
}

post {
  url: {{host}}/api/auth
  body: json
  auth: inherit
}

headers {
  Content-Type: application/json
}

body:json {
  {
      "username": "{{username}}",
      "password": "{{password}}",
      "appId": "{{appId}}"
  }
}

script:post-response {
  var jsonData = res.getBody();
  bru.setEnvVar("challenge", jsonData.challenge);
  bru.setEnvVar("token", jsonData.token);
}

settings {
  encodeUrl: true
  timeout: 0
}
